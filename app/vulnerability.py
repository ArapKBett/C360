import requests
from urllib.parse import urljoin
import re

def scan_vulnerabilities(url):
    result = []
    try:
        # Basic XSS check
        test_payload = "<script>alert('test')</script>"
        response = requests.get(url, params={'q': test_payload}, timeout=5)
        if test_payload in response.text:
            result.append({'vulnerability': 'XSS', 'details': 'Possible reflected XSS detected'})
        
        # Basic SQLi check
        sqli_payload = "' OR '1'='1"
        response = requests.get(url, params={'id': sqli_payload}, timeout=5)
        if re.search(r'error|sql|syntax', response.text, re.IGNORECASE):
            result.append({'vulnerability': 'SQLi', 'details': 'Possible SQL injection detected'})
        
        return result if result else [{'vulnerability': 'None', 'details': 'No vulnerabilities detected'}]
    except Exception as e:
        raise Exception(f"Vulnerability scan failed: {str(e)}")
